name: Notion Insert Mock

on:
  workflow_dispatch:

jobs:
  notion_insert:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Run Notion Insert Script (Mock)
        id: run_script
        run: |
          set +e
          python scripts/notion_insert.py > script_output.log 2>&1
          exit_code=$?
          echo "exit_code=$exit_code" >> $GITHUB_OUTPUT
          if [ $exit_code -ne 0 ]; then
            echo "status=failed" >> $GITHUB_OUTPUT
            # Slack用にエラー内容をBase64エンコード（改行対策）
            error_msg=$(base64 -w0 script_output.log)
            echo "error_message=$error_msg" >> $GITHUB_OUTPUT
          else
            echo "status=su
